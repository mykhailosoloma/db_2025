# Лабораторна робота: Проєктування бази даних для платформи онлайн-курсів

## 1. Короткий виклад вимог

### Потреби зацікавлених сторін:
* **Студент:** Пошук курсів, запис на них, проходження уроків, відстеження власного прогресу та отримання сертифікатів.
* **Інструктор:** Створення та редагування курсів, додавання навчальних матеріалів (модулів, уроків), перегляд списку студентів та їх успішності.
* **Адміністратор:** Управління користувачами (студентами та інструкторами), модерація курсів та відгуків.

### Дані для зберігання:
* Інформація про користувачів, їх персональні дані та ролі (студент, інструктор, адміністратор).
* Дані про курси: назва, опис, категорія, автор курсу.
* Структура курсу: модулі, що входять до курсу, та уроки, що входять до модулів.
* Контент уроків: текст, посилання на відео, додаткові файли.
* Інформація про зарахування студентів на курси.
* Дані про прогрес студентів (які уроки завершено).
* Відгуки та рейтинги, які студенти залишають до курсів.
* Інформація про видані сертифікати після успішного завершення курсу.

### Бізнес-правила:
1.  Користувач не може зареєструватися, якщо його електронна пошта вже існує в системі.
2.  Тільки користувач з роллю "Інструктор" може створювати та редагувати курси.
3.  Студент повинен бути зарахований на курс, щоб отримати доступ до його матеріалів.
4.  Прогрес проходження курсу відстежується на рівні окремих уроків.
5.  Сертифікат видається лише після завершення всіх уроків у курсі.
6.  Студент може залишити відгук лише на той курс, на який він зарахований.
7.  Рейтинг курсу розраховується як середнє арифметичне всіх оцінок у відгуках.

---

## 2. Список сутностей з атрибутами та пояснення зв'язків

### Сутності

#### `User` (Користувач)
* **`id` (PK):** Унікальний ідентифікатор користувача.
* **`email`:** Електронна пошта (унікальна, обов'язкова).
* **`firstName`:** Ім'я користувача (обов'язкове).
* **`lastName`:** Прізвище користувача (обов'язкове).
* **`password`:** Хеш пароля (обов'язкове).
* **`role`:** Роль користувача (`STUDENT`, `INSTRUCTOR`, `ADMIN`, обов'язкове).
* **`created_at`:** Дата створення облікового запису.

#### `Course` (Курс)
* **`id` (PK):** Унікальний ідентифікатор курсу.
* **`instructor_id` (FK):** Посилання на автора курсу (користувача-інструктора).
* **`title`:** Назва курсу (обов'язкова).
* **`description`:** Детальний опис курсу.
* **`category`:** Категорія курсу (напр. "Програмування", "Дизайн").
* **`created_at`:** Дата створення курсу.

#### `Module` (Модуль)
* **`id` (PK):** Унікальний ідентифікатор модуля.
* **`course_id` (FK):** Посилання на курс, до якого належить модуль.
* **`title`:** Назва модуля (обов'язкова).
* **`order_index`:** Порядковий номер модуля в курсі.

#### `Lesson` (Урок)
* **`id` (PK):** Унікальний ідентифікатор уроку.
* **`module_id` (FK):** Посилання на модуль, до якого належить урок.
* **`title`:** Назва уроку (обов'язкова).
* **`content_type`:** Тип контенту (`VIDEO`, `TEXT`, `QUIZ`).
* **`content_data`:** Дані уроку (URL відео, текст, посилання на тест).
* **`order_index`:** Порядковий номер уроку в модулі.

#### `Enrollment` (Зарахування)
* **`id` (PK):** Унікальний ідентифікатор запису про зарахування.
* **`user_id` (FK):** Посилання на студента.
* **`course_id` (FK):** Посилання на курс.
* **`enrollment_date`:** Дата зарахування на курс.

#### `Progress` (Прогрес)
* **`id` (PK):** Унікальний ідентифікатор запису про прогрес.
* **`enrollment_id` (FK):** Посилання на конкретне зарахування.
* **`lesson_id` (FK):** Посилання на пройдений урок.
* **`completed_at`:** Дата та час завершення уроку.

#### `Review` (Відгук)
* **`id` (PK):** Унікальний ідентифікатор відгуку.
* **`user_id` (FK):** Посилання на студента, що залишив відгук.
* **`course_id` (FK):** Посилання на курс, що оцінюється.
* **`rating`:** Оцінка курсу (1-5, обов'язкова).
* **`comment`:** Текст відгуку.
* **`created_at`:** Дата створення відгуку.

#### `Certificate` (Сертифікат)
* **`id` (PK):** Унікальний ідентифікатор сертифіката.
* **`user_id` (FK):** Посилання на студента, що отримав сертифікат.
* **`course_id` (FK):** Посилання на завершений курс.
* **`issue_date`:** Дата видачі сертифіката.
* **`certificate_url`:** Унікальне посилання на згенерований сертифікат.

### Пояснення зв'язків

#### Зв'язки один-до-багатьох (`1:N`)
* **`User` (Instructor) → `Course`:** Один інструктор може створити багато курсів, але кожен курс має лише одного автора-інструктора.
* **`Course` → `Module`:** Один курс складається з багатьох модулів, але кожен модуль належить тільки одному курсу.
* **`Module` → `Lesson`:** Один модуль містить багато уроків, але кожен урок належить тільки одному модулю.
* **`Course` → `Review`:** Один курс може мати багато відгуків, але кожен відгук стосується лише одного курсу.
* **`User` → `Review`:** Один користувач (студент) може залишити багато відгуків (на різні курси), але кожен відгук залишений одним користувачем.
* **`Enrollment` → `Progress`:** Одне зарахування (конкретний студент на конкретному курсі) може мати багато записів про прогрес (по одному на кожен завершений урок).

#### Зв'язки багато-до-багатьох (`N:N`)
* **`User` ↔ `Course` (через `Enrollment`):** Один студент може бути зарахований на багато курсів, і один курс може мати багато зарахованих студентів. Цей зв'язок реалізовано через проміжну таблицю `Enrollment`.
* **`User` ↔ `Course` (через `Certificate`):** Один студент може отримати багато сертифікатів (за різні курси), і по одному курсу може бути видано багато сертифікатів (різним студентам). Реалізовано через таблицю `Certificate`.
* **`Enrollment` ↔ `Lesson` (через `Progress`):** Цей зв'язок показує, які уроки завершені в рамках конкретного зарахування. Один студент (в рамках зарахування) проходить багато уроків, і один урок проходять багато студентів. Реалізовано через таблицю `Progress`.

---

## 3. Обмеження

1.  **Рейтинг курсу:** Обмежений цілими числами в діапазоні від 1 до 5.
2.  **Унікальність зарахування:** Пара (`user_id`, `course_id`) в таблиці `Enrollment` має бути унікальною, щоб студент не міг записатися на той самий курс двічі.
3.  **Доступ до відгуків:** Створення запису в таблиці `Review` для пари (`user_id`, `course_id`) можливе лише за наявності відповідного запису в `Enrollment`.
4.  **Обов'язкові поля:** `email` в таблиці `User` має бути унікальним і не може бути `NULL`.
5.  **Ролі користувача:** Поле `role` в `User` може приймати лише одне зі значень: `STUDENT`, `INSTRUCTOR`, `ADMIN`.
6.  **Порядкові індекси:** Поля `order_index` в `Module` та `Lesson` використовуються для сортування і не повинні бути від'ємними.
7.  **Видача сертифіката:** Запис у таблицю `Certificate` може бути створений лише тоді, коли для даного `user_id` та `course_id` існують записи в `Progress` для всіх уроків цього курсу.