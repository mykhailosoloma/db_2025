# Звіт з лабораторної роботи №5: Нормалізація бази даних

## 1. Аналіз початкової схеми
Початкова схема бази даних LMS (Learning Management System) складалася з 8 таблиць. В цілому структура відповідала 1NF та 2NF, оскільки використовувалися сурогатні первинні ключі (`SERIAL`), а атомарність даних була дотримана.

Однак було виявлено порушення **3-ї нормальної форми (3NF)** в таблиці `courses`.

### Проблемна таблиця: `courses`
**Початковий вигляд:**
| course_id | title | ... | category (VARCHAR) |
|-----------|-------|-----|--------------------|
| 1         | SQL   | ... | Databases          |
| 2         | Docker| ... | DevOps             |
| 3         | Linux | ... | DevOps             |

**Аномалії:**
1. **Надлишковість:** Рядок "DevOps" повторюється багато разів. Це займає зайве місце.
2. **Аномалія оновлення:** Щоб змінити назву категорії, потрібно оновити всі записи курсів.
3. **Аномалія вставки:** Неможливо створити нову категорію (наприклад, "AI"), поки немає жодного курсу в цій категорії.

## 2. Функціональні залежності (FD)

Для таблиці `courses`:
* `course_id -> title`
* `course_id -> description`
* `course_id -> instructor_id`
* `course_id -> category` (Транзитивна залежність, якщо ми вважаємо Категорію сутністю)

Порушення 3NF: Атрибут `category` (неключовий) залежить від `course_id` (ключа), але семантично категорія є окремою сутністю, яка може мати свій опис.

## 3. Процес нормалізації

### Крок 1: Перевірка 1NF (Перша нормальна форма)
Вимога: Усі атрибути мають бути атомарними.
Аналіз: У таблиці `lessons` поле `content_data` містить посилання або текст. Це атомарні значення з точки зору БД. Списків або масивів немає.
Висновок: Таблиці знаходяться в 1NF.

### Крок 2: Перевірка 2NF (Друга нормальна форма)
Вимога: Відсутність часткових залежностей (коли атрибут залежить лише від частини складеного ключа).
Аналіз: Оскільки всі основні таблиці (`users`, `courses` тощо) мають простий первинний ключ (`id`), часткові залежності відсутні.
У таблиці `enrollments` є складений унікальний ключ `(user_id, course_id)`, але атрибут `enrollment_date` залежить від повної пари (конкретний студент записався на конкретний курс), тому 2NF дотримано.

### Крок 3: Перехід до 3NF (Третя нормальна форма)
Вимога: Відсутність транзитивних залежностей (неключовий атрибут залежить від іншого неключового).

**Дія:** Декомпозиція таблиці `courses`.
1. Створюємо нову таблицю `categories`.
2. Замінюємо поле `category` (VARCHAR) в таблиці `courses` на `category_id` (INTEGER, Foreign Key).

**Дія (додатково):** Декомпозиція таблиці `users`.
1. Створюємо таблицю `roles` (щоб уникнути hardcode рядків 'STUDENT', 'ADMIN').
2. Замінюємо `role` на `role_id`.

## 4. Фінальна схема (зміни)

**Нова таблиця `categories`:**
* `category_id` (PK)
* `name` (unique)

**Оновлена таблиця `courses`:**
* `course_id` (PK)
* `category_id` (FK -> categories)
* ...інші поля...

Це усуває дублювання тексту та захищає від помилок написання категорій.